<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LSKK - Papan Tugas Tim</title>
    
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* Custom styles to complement Tailwind */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        /* Simple animation for views and modals */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .view-container, .task-card {
            animation: fadeIn 0.3s ease-out;
        }
        /* Custom scrollbar for Kanban columns */
        .tasks-container::-webkit-scrollbar {
            width: 6px;
        }
        .tasks-container::-webkit-scrollbar-track {
            background: #e2e8f0; /* slate-200 */
            border-radius: 10px;
        }
        .tasks-container::-webkit-scrollbar-thumb {
            background: #94a3b8; /* slate-400 */
            border-radius: 10px;
        }
        .tasks-container::-webkit-scrollbar-thumb:hover {
            background: #64748b; /* slate-500 */
        }
    </style>
</head>
<body class="text-slate-800">

    <!-- App Header -->
    <header class="bg-white shadow-sm sticky top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-2">
                    <svg class="h-8 w-8 text-teal-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <h1 class="text-2xl font-bold text-slate-800">LSKK</h1>
                </div>
                <nav class="hidden md:flex items-center space-x-2 bg-slate-100 p-1 rounded-lg">
                    <button id="nav-dashboard" class="nav-button px-4 py-2 text-sm font-semibold rounded-md">ğŸ“‹ Papan Tugas</button>
                    <button id="nav-table" class="nav-button px-4 py-2 text-sm font-semibold rounded-md">ğŸ“„ List Tabel</button>
                    <button id="nav-admin" class="nav-button px-4 py-2 text-sm font-semibold rounded-md">âš™ï¸ Admin & Kontrol</button>
                </nav>
                <!-- Mobile Menu Button -->
                 <div class="md:hidden">
                    <select id="mobile-nav" class="block w-full rounded-md border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 sm:text-sm">
                        <option value="dashboard">Papan Tugas</option>
                        <option value="table">List Tabel</option>
                        <option value="admin">Admin & Kontrol</option>
                    </select>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

        <!-- Admin View -->
        <div id="admin-view" class="view-container hidden">
            <div class="grid grid-cols-1 lg:grid-cols-5 gap-8">
                <!-- Project Management -->
                <section class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                    <h3 class="text-lg font-bold mb-4">Manajemen Proyek</h3>
                    <form id="project-form" class="flex items-center gap-2 mb-4">
                        <input type="text" id="project-name" placeholder="Nama Proyek Baru..." required class="flex-grow w-full px-3 py-2 bg-slate-50 border border-slate-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                        <button type="submit" title="Tambah Proyek" class="bg-teal-500 hover:bg-teal-600 text-white font-bold p-2 rounded-md transition">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                        </button>
                    </form>
                    <ul id="project-list" class="space-y-2"></ul>
                </section>

                <!-- New Task Form -->
                <section class="lg:col-span-3 bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                    <h3 class="text-lg font-bold mb-4">Tambah Tugas Baru</h3>
                    <form id="task-form" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="md:col-span-2">
                            <label for="task-description" class="block text-sm font-medium text-slate-600 mb-1">Deskripsi Tugas</label>
                            <input type="text" id="task-description" placeholder="Contoh: Buat halaman login..." required class="w-full px-3 py-2 bg-slate-50 border border-slate-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                        </div>
                        <div>
                            <label for="task-project" class="block text-sm font-medium text-slate-600 mb-1">Proyek</label>
                            <select id="task-project" required class="w-full px-3 py-2 bg-slate-50 border border-slate-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition"><option value="">Pilih Proyek</option></select>
                        </div>
                        <div>
                            <label for="task-pic" class="block text-sm font-medium text-slate-600 mb-1">Anggota Tim</label>
                            <select id="task-pic" required class="w-full px-3 py-2 bg-slate-50 border border-slate-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition"><option value="">Pilih Anggota Tim</option></select>
                        </div>
                        <div class="md:col-span-2">
                             <label for="task-due-date" class="block text-sm font-medium text-slate-600 mb-1">Deadline</label>
                             <input type="date" id="task-due-date" required class="w-full px-3 py-2 bg-slate-50 border border-slate-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                        </div>
                        <div class="md:col-span-2 text-right">
                            <button type="submit" class="w-full md:w-auto bg-teal-500 hover:bg-teal-600 text-white font-semibold py-2 px-6 rounded-md transition shadow">Buat Tugas</button>
                        </div>
                    </form>
                </section>
            </div>
        </div>

        <!-- Common Filter Bar -->
        <div id="filter-bar" class="hidden bg-white p-4 rounded-xl shadow-sm border border-slate-200 mb-6">
             <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label for="project-filter" class="block text-sm font-medium text-slate-600 mb-1">ğŸ“ Filter Proyek</label>
                    <select id="project-filter" class="w-full px-3 py-2 bg-slate-50 border border-slate-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition"></select>
                </div>
                 <div>
                    <label for="member-filter" class="block text-sm font-medium text-slate-600 mb-1">ğŸ§‘â€ğŸ’» Filter Anggota</label>
                    <select id="member-filter" class="w-full px-3 py-2 bg-slate-50 border border-slate-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition"></select>
                </div>
            </div>
        </div>

        <!-- Table View -->
        <div id="table-view" class="view-container hidden">
            <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="w-full text-sm text-left text-slate-600">
                        <thead class="text-xs text-slate-700 uppercase bg-slate-100">
                            <tr>
                                <th scope="col" class="px-6 py-3">Tugas</th>
                                <th scope="col" class="px-6 py-3">Proyek</th>
                                <th scope="col" class="px-6 py-3">PIC</th>
                                <th scope="col" class="px-6 py-3">Deadline</th>
                                <th scope="col" class="px-6 py-3">Status</th>
                            </tr>
                        </thead>
                        <tbody id="task-table-body">
                            <!-- Rows will be injected by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Dashboard/Kanban View -->
        <div id="dashboard-view" class="view-container">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- To Do Column -->
                <div class="bg-slate-100 rounded-xl p-4">
                    <h2 class="flex items-center justify-center gap-2 font-bold text-center text-red-600 bg-red-100 p-2 rounded-md mb-4">
                        <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6m0 0v6m0-6h6m-6 0H6" /></svg>
                        Belum Dikerjakan
                    </h2>
                    <div id="todo-tasks" class="tasks-container space-y-4 h-[60vh] overflow-y-auto p-1"></div>
                </div>
                <!-- In Progress Column -->
                <div class="bg-slate-100 rounded-xl p-4">
                    <h2 class="flex items-center justify-center gap-2 font-bold text-center text-blue-600 bg-blue-100 p-2 rounded-md mb-4">
                        <svg class="w-5 h-5 animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                        Sedang Dikerjakan
                    </h2>
                    <div id="inprogress-tasks" class="tasks-container space-y-4 h-[60vh] overflow-y-auto p-1"></div>
                </div>
                <!-- Done Column -->
                <div class="bg-slate-100 rounded-xl p-4">
                    <h2 class="flex items-center justify-center gap-2 font-bold text-center text-green-600 bg-green-100 p-2 rounded-md mb-4">
                        <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
                        Selesai
                    </h2>
                    <div id="done-tasks" class="tasks-container space-y-4 h-[60vh] overflow-y-auto p-1"></div>
                </div>
            </div>
        </div>
    </main>

    <!-- Custom Modal for Notifications and Prompts -->
    <div id="modal-backdrop" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
        <div id="modal-content" class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-md transform transition-all">
            <h3 id="modal-title" class="text-lg font-bold text-slate-800"></h3>
            <p id="modal-message" class="mt-2 text-sm text-slate-600"></p>
            <input type="text" id="modal-input" class="hidden w-full mt-4 px-3 py-2 bg-slate-50 border border-slate-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition" placeholder="Masukkan kode otorisasi...">
            <div id="modal-actions" class="mt-6 flex justify-end space-x-3">
                <!-- Buttons will be injected by JS -->
            </div>
        </div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {

    // --- CONFIGURATION ---
    const DELETION_CODE = 'LSKK2025';
    const teamMembers = [
        "Asep Trisna Setiawan (PM)", "M. Aji Perdana (Backend Developer)", "M. Rizki Fahreaza (Mobile Developer)",
        "Faiza Kailani Kuswanto (Website Developer)", "Ahmad Sholeh Kurniawan (Mobile Developer)", "Harist Fadilah (Website Developer)","M DaffM. Daffa Prasetyo(UI/UX Designer)", "M Riza Nurtam (Infra)"
    ];

    // --- DOM ELEMENTS ---
    const navButtons = document.querySelectorAll('.nav-button');
    const mobileNav = document.getElementById('mobile-nav');
    const views = {
        admin: document.getElementById('admin-view'),
        dashboard: document.getElementById('dashboard-view'),
        table: document.getElementById('table-view')
    };
    const filterBar = document.getElementById('filter-bar');

    // Admin View
    const projectForm = document.getElementById('project-form');
    const projectNameInput = document.getElementById('project-name');
    const projectList = document.getElementById('project-list');
    
    // Task Form
    const taskForm = document.getElementById('task-form');
    const taskDescriptionInput = document.getElementById('task-description');
    const taskPicSelect = document.getElementById('task-pic');
    const taskProjectSelect = document.getElementById('task-project');
    const taskDueDateInput = document.getElementById('task-due-date');
    
    // Filters (Unified)
    const projectFilter = document.getElementById('project-filter');
    const memberFilter = document.getElementById('member-filter');
    
    // Kanban Containers
    const todoTasksContainer = document.getElementById('todo-tasks');
    const inprogressTasksContainer = document.getElementById('inprogress-tasks');
    const doneTasksContainer = document.getElementById('done-tasks');
    
    // Table Container
    const taskTableBody = document.getElementById('task-table-body');
    
    // Modal Elements
    const modalBackdrop = document.getElementById('modal-backdrop');
    const modalContent = document.getElementById('modal-content');
    const modalTitle = document.getElementById('modal-title');
    const modalMessage = document.getElementById('modal-message');
    const modalInput = document.getElementById('modal-input');
    const modalActions = document.getElementById('modal-actions');


    // --- MODAL FUNCTIONS ---
    const showModal = (title, message, buttons, showInput = false) => {
        modalTitle.textContent = title;
        modalMessage.textContent = message;
        modalInput.classList.toggle('hidden', !showInput);
        modalInput.value = '';
        modalActions.innerHTML = '';
        buttons.forEach(btn => {
            const buttonEl = document.createElement('button');
            buttonEl.textContent = btn.text;
            buttonEl.className = btn.class;
            buttonEl.onclick = () => {
                hideModal();
                if (btn.onClick) btn.onClick();
            };
            modalActions.appendChild(buttonEl);
        });
        modalBackdrop.classList.remove('hidden');
        modalContent.style.animation = 'fadeIn 0.2s ease-out';
    };

    const hideModal = () => {
        modalBackdrop.classList.add('hidden');
    };

    const notify = (title, message) => {
        showModal(title, message, [{ text: 'Tutup', class: 'bg-teal-500 hover:bg-teal-600 text-white font-semibold py-2 px-4 rounded-md transition' }]);
    };

    const confirmAction = (title, message, onConfirm) => {
        showModal(title, message, [
            { text: 'Batal', class: 'bg-slate-200 hover:bg-slate-300 text-slate-700 font-semibold py-2 px-4 rounded-md transition' },
            { text: 'Konfirmasi', class: 'bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-md transition', onClick: onConfirm }
        ]);
    };
    
    const promptWithCode = (title, message, onConfirm) => {
        showModal(title, message, [
             { text: 'Batal', class: 'bg-slate-200 hover:bg-slate-300 text-slate-700 font-semibold py-2 px-4 rounded-md transition' },
             { text: 'Hapus', class: 'bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-md transition', onClick: () => onConfirm(modalInput.value) }
        ], true);
    };

    // --- NAVIGATION ---
    const switchView = (viewName) => {
        Object.values(views).forEach(v => v.classList.add('hidden'));
        filterBar.classList.add('hidden');

        if (views[viewName]) {
            views[viewName].classList.remove('hidden');
            if (viewName === 'dashboard' || viewName === 'table') {
                filterBar.classList.remove('hidden');
            }
        }

        // Update active state for desktop nav
        navButtons.forEach(btn => {
            btn.classList.toggle('bg-teal-500', btn.id === `nav-${viewName}`);
            btn.classList.toggle('text-white', btn.id === `nav-${viewName}`);
            btn.classList.toggle('text-slate-600', btn.id !== `nav-${viewName}`);
        });
        // Update mobile nav
        mobileNav.value = viewName;
    };

    // --- DATABASE (localStorage) ---
    const getProjects = () => JSON.parse(localStorage.getItem('lskk_projectsDB_v2')) || [];
    const saveProjects = (projects) => localStorage.setItem('lskk_projectsDB_v2', JSON.stringify(projects));
    const getTasks = () => JSON.parse(localStorage.getItem('lskk_tasksDB_v2')) || [];
    const saveTasks = (tasks) => localStorage.setItem('lskk_tasksDB_v2', JSON.stringify(tasks));

    // --- DATA MANAGEMENT ---
    const addProject = (e) => {
        e.preventDefault();
        const newName = projectNameInput.value.trim();
        if (newName) {
            const projects = getProjects();
            if (projects.some(p => p.name.toLowerCase() === newName.toLowerCase())) {
                return notify("Gagal", "Nama proyek sudah ada. Silakan gunakan nama lain.");
            }
            projects.push({ id: Date.now(), name: newName });
            saveProjects(projects);
            projectNameInput.value = "";
            renderAll();
        }
    };

    const deleteProject = (id) => {
        const projects = getProjects();
        const projectToDelete = projects.find(p => p.id === id);
        if (!projectToDelete) return;

        promptWithCode(
            `Hapus Proyek "${projectToDelete.name}"`,
            "Tindakan ini akan menghapus proyek dan SEMUA tugas yang terkait secara permanen. Masukkan kode otorisasi untuk melanjutkan.",
            (code) => {
                if (code !== DELETION_CODE) {
                    return notify("Gagal", "Kode otorisasi salah.");
                }
                let currentProjects = getProjects().filter(p => p.id !== id);
                saveProjects(currentProjects);
                let currentTasks = getTasks().filter(t => t.project !== projectToDelete.name);
                saveTasks(currentTasks);
                renderAll();
                notify("Sukses", `Proyek "${projectToDelete.name}" telah dihapus.`);
            }
        );
    };

    const addTask = (e) => {
        e.preventDefault();
        const task = {
            id: Date.now(),
            description: taskDescriptionInput.value.trim(),
            pic: taskPicSelect.value,
            project: taskProjectSelect.value,
            dueDate: taskDueDateInput.value,
            status: "todo"
        };
        const tasks = getTasks();
        tasks.push(task);
        saveTasks(tasks);
        taskForm.reset();
        notify("Sukses", "Tugas baru telah ditambahkan!");
        applyFilters();
    };

    const deleteTask = (id) => {
         promptWithCode(
            "Hapus Tugas",
            "Anda yakin ingin menghapus tugas ini? Masukkan kode otorisasi.",
            (code) => {
                if (code !== DELETION_CODE) {
                    return notify("Gagal", "Kode otorisasi salah.");
                }
                let tasks = getTasks().filter(t => t.id !== id);
                saveTasks(tasks);
                applyFilters();
                notify("Sukses", "Tugas telah dihapus.");
            }
        );
    };

    const updateTaskStatus = (id, newStatus) => {
        let tasks = getTasks();
        const taskIndex = tasks.findIndex(t => t.id === id);
        if (taskIndex > -1) {
            tasks[taskIndex].status = newStatus;
            saveTasks(tasks);
            applyFilters();
        }
    };

    // --- RENDER FUNCTIONS ---
    const applyFilters = () => {
        const selectedProject = projectFilter.value;
        const selectedMember = memberFilter.value;
        renderTasks(selectedProject, selectedMember);
        renderTable(selectedProject, selectedMember);
    };

    const renderTasks = (project, member) => {
        let tasksToRender = getTasks();
        if (project !== 'all') tasksToRender = tasksToRender.filter(t => t.project === project);
        if (member !== 'all') tasksToRender = tasksToRender.filter(t => t.pic === member);

        [todoTasksContainer, inprogressTasksContainer, doneTasksContainer].forEach(c => c.innerHTML = '');
        
        if (tasksToRender.length === 0) {
            // Can add a placeholder message if needed
        }

        tasksToRender.forEach(task => {
            const card = createTaskCard(task);
            if (task.status === 'todo') todoTasksContainer.appendChild(card);
            else if (task.status === 'inprogress') inprogressTasksContainer.appendChild(card);
            else if (task.status === 'done') doneTasksContainer.appendChild(card);
        });
    };

    const renderTable = (project, member) => {
        let tasksToRender = getTasks();
        if (project !== 'all') tasksToRender = tasksToRender.filter(t => t.project === project);
        if (member !== 'all') tasksToRender = tasksToRender.filter(t => t.pic === member);

        taskTableBody.innerHTML = '';
        
        if (tasksToRender.length === 0) {
            taskTableBody.innerHTML = `<tr><td colspan="5" class="text-center p-8 text-slate-500">Tidak ada tugas yang sesuai dengan filter.</td></tr>`;
            return;
        }

        tasksToRender.forEach(task => {
            const row = document.createElement('tr');
            row.className = 'bg-white border-b hover:bg-slate-50';
            
            const statusMap = {
                todo: { text: "Belum Dikerjakan", class: "bg-red-100 text-red-800" },
                inprogress: { text: "Dikerjakan", class: "bg-blue-100 text-blue-800" },
                done: { text: "Selesai", class: "bg-green-100 text-green-800" }
            };
            const statusInfo = statusMap[task.status] || {text: 'N/A', class: 'bg-gray-100 text-gray-800'};

            row.innerHTML = `
                <td class="px-6 py-4 font-medium text-slate-900">${task.description}</td>
                <td class="px-6 py-4">${task.project}</td>
                <td class="px-6 py-4">${task.pic}</td>
                <td class="px-6 py-4">${task.dueDate}</td>
                <td class="px-6 py-4">
                    <span class="px-3 py-1 text-xs font-semibold rounded-full ${statusInfo.class}">${statusInfo.text}</span>
                </td>
            `;
            taskTableBody.appendChild(row);
        });
    };
    
    const createTaskCard = (task) => {
        const card = document.createElement("div");
        card.className = "task-card bg-white p-4 rounded-lg shadow-sm border border-slate-200 cursor-pointer hover:shadow-md hover:-translate-y-1 transition-all duration-200";
        card.setAttribute("data-id", task.id);

        const statusStyles = {
            todo: 'border-l-4 border-red-500',
            inprogress: 'border-l-4 border-blue-500',
            done: 'border-l-4 border-green-500'
        };
        card.classList.add(statusStyles[task.status]);

        card.innerHTML = `
            <p class="font-semibold text-slate-800 mb-3">${task.description}</p>
            <div class="text-xs text-slate-500 space-y-2 mb-4">
                <div class="flex items-center gap-2"><span class="font-medium bg-slate-100 px-2 py-0.5 rounded">ğŸ“ Proyek:</span><span>${task.project}</span></div>
                <div class="flex items-center gap-2"><span class="font-medium bg-slate-100 px-2 py-0.5 rounded">ğŸ§‘â€ğŸ’» PIC:</span><span>${task.pic}</span></div>
                <div class="flex items-center gap-2"><span class="font-medium bg-slate-100 px-2 py-0.5 rounded">ğŸ—“ï¸ Deadline:</span><span>${task.dueDate}</span></div>
            </div>
            <div class="flex items-center justify-between border-t border-slate-200 pt-3">
                <select class="status-changer text-xs w-full bg-slate-50 border-slate-200 rounded-md p-1 focus:ring-1 focus:ring-teal-500 focus:border-teal-500">
                    <option value="todo" ${task.status === "todo" ? "selected" : ""}>Belum Dikerjakan</option>
                    <option value="inprogress" ${task.status === "inprogress" ? "selected" : ""}>Dikerjakan</option>
                    <option value="done" ${task.status === "done" ? "selected" : ""}>Selesai</option>
                </select>
                <button class="delete-task-btn text-slate-400 hover:text-red-500 transition ml-2 p-1 rounded-full hover:bg-red-100" title="Hapus Tugas">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                </button>
            </div>
        `;
        card.querySelector(".delete-task-btn").addEventListener("click", (e) => {
            e.stopPropagation();
            deleteTask(task.id);
        });
        card.querySelector(".status-changer").addEventListener("change", e => updateTaskStatus(task.id, e.target.value));
        return card;
    };

    const renderProjectList = () => {
        projectList.innerHTML = "";
        const projects = getProjects();
        if (projects.length === 0) {
            projectList.innerHTML = `<li class="text-sm text-slate-500 text-center p-4">Belum ada proyek.</li>`;
            return;
        }
        projects.forEach(p => {
            const li = document.createElement("li");
            li.className = "flex items-center justify-between text-sm p-2 rounded-md hover:bg-slate-100";
            li.innerHTML = `
                <span class="font-medium">${p.name}</span>
                <button class="delete-project-btn text-slate-400 hover:text-red-500 transition p-1 rounded-full hover:bg-red-100" title="Hapus proyek ${p.name}">
                     <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            `;
            li.querySelector(".delete-project-btn").onclick = () => deleteProject(p.id);
            projectList.appendChild(li);
        });
    };

    const populateDropdowns = () => {
        const projects = getProjects();
        const members = teamMembers;

        // Populate Project Selects
        [taskProjectSelect, projectFilter].forEach(s => {
            const currentVal = s.value;
            s.innerHTML = `<option value="">Pilih Proyek</option>`;
            if (s.id.includes('filter')) {
                s.innerHTML += `<option value="all">Semua Proyek</option>`;
            }
            projects.forEach(p => s.innerHTML += `<option value="${p.name}">${p.name}</option>`);
            s.value = currentVal;
        });

        // Populate PIC/Member Selects
        [taskPicSelect, memberFilter].forEach(s => {
            const currentVal = s.value;
            s.innerHTML = `<option value="">Pilih Anggota Tim</option>`;
            if (s.id.includes('filter')) {
                s.innerHTML += `<option value="all">Semua Anggota</option>`;
            }
            members.forEach(m => s.innerHTML += `<option value="${m}">${m}</option>`);
            s.value = currentVal;
        });
    };

    const renderAll = () => {
        populateDropdowns();
        renderProjectList();
        applyFilters();
    };

    // --- EVENT LISTENERS ---
    navButtons.forEach(button => {
        button.addEventListener('click', () => switchView(button.id.replace('nav-', '')));
    });
    mobileNav.addEventListener('change', (e) => switchView(e.target.value));

    projectForm.addEventListener('submit', addProject);
    taskForm.addEventListener('submit', addTask);

    projectFilter.addEventListener('change', applyFilters);
    memberFilter.addEventListener('change', applyFilters);
    
    // --- INITIALIZATION ---
    renderAll();
    switchView('dashboard'); // Default view
});
</script>

</body>
</html>

<!-- <!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LSKK - Papan Tugas Tim</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header class="app-header">
        <div class="logo">
            <h1>LSKK</h1>
        </div>
        <nav class="app-nav">
            <button id="nav-dashboard" class="nav-button active">ğŸ“‹ Papan Tugas</button>
            <button id="nav-table" class="nav-button">ğŸ“„ List Tabel</button>
            <button id="nav-admin" class="nav-button">âš™ï¸ Admin & Kontrol</button>
        </nav>
    </header>

    <main class="app-container">
        
        <div id="admin-view" class="view-container hidden">
            <div class="controls-wrapper">
                <div class="controls-grid">
                    <section class="control-card project-management">
                        <h3>Manajemen Proyek</h3>
                        <form id="project-form"><input type="text" id="project-name" placeholder="Nama Proyek Baru..." required><button type="submit" title="Tambah Proyek">â•</button></form>
                        <ul id="project-list"></ul>
                    </section>
                    <section class="control-card task-form-section">
                        <h3>Tambah Tugas Baru</h3>
                        <form id="task-form"><input type="text" id="task-description" placeholder="Deskripsi Tugas..." required><select id="task-project" required><option value="">Pilih Proyek</option></select><select id="task-pic" required><option value="">Pilih Anggota Tim</option></select><input type="date" id="task-due-date" required><button type="submit">Buat Tugas</button></form>
                    </section>
                </div>
            </div>
        </div>

        <div id="table-view" class="view-container hidden">
            <div class="filters-wrapper">
                <div class="filter-group"><label for="project-filter-table">ğŸ“ Filter Proyek</label><select id="project-filter-table"></select></div>
                <div class="filter-group"><label for="member-filter-table">ğŸ§‘â€ğŸ’» Filter Anggota</label><select id="member-filter-table"></select></div>
            </div>
            <div class="table-container">
                <table class="task-table">
                    <thead>
                        <tr>
                            <th>Tugas</th>
                            <th>Proyek</th>
                            <th>Penanggung Jawab (PIC)</th>
                            <th>Deadline</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="task-table-body">
                        </tbody>
                </table>
            </div>
        </div>

        <div id="dashboard-view" class="view-container">
            <div class="filters-wrapper">
                <div class="filter-group"><label for="project-filter-board">ğŸ“ Filter Proyek</label><select id="project-filter-board"></select></div>
                <div class="filter-group"><label for="member-filter-board">ğŸ§‘â€ğŸ’» Filter Anggota</label><select id="member-filter-board"></select></div>
            </div>
            <div class="kanban-board">
                <div class="kanban-column" id="todo-column"><h2 class="column-title todo">Belum Dikerjakan</h2><div class="tasks-container" id="todo-tasks"></div></div>
                <div class="kanban-column" id="inprogress-column"><h2 class="column-title inprogress">Sedang Dikerjakan</h2><div class="tasks-container" id="inprogress-tasks"></div></div>
                <div class="kanban-column" id="done-column"><h2 class="column-title done">Selesai</h2><div class="tasks-container" id="done-tasks"></div></div>
            </div>
        </div>
    </main>

    <script src="script.js"></script>
</body>
</html> -->